<html>
<head>
  <script src="https://d3js.org/d3.v6.min.js">
  </script>
  <style>
    table, th, td {
        border: 1px solid black;
    }
  </style>
</head>
  <body>
    <input type="file" onchange="loadFile()" />
    <br />
    Actionable: <input type="text" id="Actionable" placeholder="Scale 0-1.0, default 0"/>
        <br />
        Targeted & Accurate: <input type="text" id="Accurate" placeholder="Scale 0-1.0, default 0"/>
        <br />
        Contextual: <input type="text" id="Contextual" placeholder="Scale 0-1.0, default 0"/>
        <br />
        Timely: <input type="text" id="Timely" placeholder="Scale 0-1.0, default 0"/>
        <br />
        Theme Value: <input type="text" id="Theme" placeholder="Scale 0-1.0, default 0"/>
        <br />
        <a href="javascript:sorting()">sort</a>
        <br /><br />
        <div id="container">
        </div>
        <script>
          var reader = new FileReader();  
          function loadFile() {      
            var file = document.querySelector('input[type=file]').files[0];      
            reader.addEventListener("load", sorting, false);
            if (file) {
              reader.readAsText(file);
            }      
          }
          function sorting(){   
            var Actionable= document.getElementById("Actionable").value;
            var Accurate= document.getElementById("Accurate").value;
            var Contextual= document.getElementById("Contextual").value;
            var Timely= document.getElementById("Timely").value;
            var Theme= document.getElementById("Theme").value;
            //var filePath = request.getParameter("theFilePath");
            //console.log("file",filePath)
            console.log("reader is",reader)
            var data = d3.csvParse(reader.result, d3.autoType);
                data.forEach(d => {
                    d["Result"] = d["Actionable"]*Actionable+d["Targeted & Accurate"]*Accurate+d["Contextual"]*Contextual+d["Timely"]*Timely+d["Theme Value"]*Theme;
                });
                data.sort((a, b) => d3.descending(a['Result'], b['Result']));
                console.log(data)
                    var html = '<table>';
                    html += '<tr>';
                    for( var j in data[0] ) {
                      html += '<th>' + j + '</th>';
                    }
                    html += '</tr>';
                    for( var i = 0; i < data.length; i++) {
                    html += '<tr>';
                    for( var j in data[i] ) {
                        html += '<td>' + data[i][j] + '</td>';
                    }
                    html += '</tr>';
                    }
                    html += '</table>';
                    document.getElementById('container').innerHTML = html;   

            }
        

          

          </script>
  </body>
</html>
